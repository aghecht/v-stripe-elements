{"version":3,"file":"VStripeCard.js","names":["Vue","merge","VProgressLinear","VTextField","base","extend","mixins","name","props","apiKey","type","String","required","create","default","customStyle","Object","fontName","fontUrl","hideIcon","Boolean","hidePostalCode","iconStyle","options","zip","data","card","elements","isReady","okToSubmit","stripe","computed","classes","call","theme","$vuetify","currentTheme","watch","isDark","val","oldVal","style","genStyle","update","isDisabled","disabled","mounted","checkAPIKey","loadStripe","methods","key","test","console","error","warn","clearableCallback","clear","genCard","cardProps","genCardProps","Stripe","font","genFont","on","onCardBlur","onCardChange","onCardFocus","onCardReady","mount","computedId","complete","empty","focus","invalid","webkitAutofill","value","postalCode","cssSrc","isURL","encodeURI","fonts","genInput","$createElement","attrs","id","tabindex","genProgress","loading","$slots","progress","absolute","color","height","loaderHeight","indeterminate","defaults","fontFamily","fontSize","fontSmoothing","iconColor","url","protocolAndDomainRegex","localhostDomainRegex","nonLocalhostDomainRegex","match","everythingAfterProtocol","src","document","querySelector","$root","$once","$loadScript","errorBucket","push","Error","then","$emit","catch","message","e","isFocused","processCard","lazyValue","autofocus","token","createToken","source","createSource"],"sources":["../src/VStripeCard.ts"],"sourcesContent":["// Imported Types\n/// <reference path=\"../node_modules/vuetify/src/globals.d.ts\" />\nimport Vue, { VNode } from 'vue'\nimport { VuetifyThemeVariant } from 'vuetify/types/services/theme'\nimport { ElementStyles } from '../types'\n// import mixins from './util/mixins'\n\n// 3rd Party Libs\nimport merge from 'deepmerge'\n\n// Styles\nimport './VStripeCard.sass'\n\n// Extensions and Components\nimport { VProgressLinear, VTextField } from 'vuetify/lib'\n\n// Create Base Mixins and Define Custom Properties\nconst base = Vue.extend({ mixins: [VTextField] })\n// const base = mixins(VTextField)\ninterface options extends InstanceType<typeof base> {\n  /**\n   * Props unique to VStripeCard\n   */\n  $loadScript: (url: string) => Promise<void>\n  onCardBlur: stripe.elements.handler\n  onCardChange: stripe.elements.handler\n  onCardFocus: stripe.elements.handler\n  onCardReady: stripe.elements.handler\n  /**\n   * Props that **should** have been inherited from VTextField\n   * TODO: Figure out why these types aren't being recognized automatically\n   */\n  // autofocus: boolean\n  // color: string | null\n  // computedId: string\n  // disabled: boolean\n  // errorBucket: string[]\n  // iconStyle: 'default' | 'solid'\n  // isDark: boolean\n  // isFocused: boolean\n  // labelWidth: number | string\n  // lazyValue: any\n  // loaderHeight: number | string\n  // loading: string | boolean\n  // outlined: boolean\n  // $vuetify: Framework\n}\n\n// Extend VTextField to define the VStripeCard component\nexport default base.extend<options>().extend({\n  name: 'v-stripe-card',\n  props: {\n    apiKey: {\n      type: String,\n      required: true,\n    },\n    create: {\n      type: String,\n      default: 'token',\n    },\n    customStyle: {\n      type: Object,\n      default: () => ({}),\n    },\n    fontName: {\n      type: String,\n      default: 'Roboto',\n    },\n    fontUrl: {\n      type: String,\n      default: '',\n    },\n    hideIcon: Boolean,\n    hidePostalCode: Boolean,\n    iconStyle: {\n      type: String,\n      default: 'default',\n    },\n    options: {\n      type: Object,\n      /**\n       * TODO: Document available options in README.md\n       * These can be any and all available options for creating\n       * either a token or a source.\n       */\n      default: () => ({}),\n    },\n    zip: {\n      type: String,\n      default: '',\n    },\n  },\n  data: () => ({\n    card: null as stripe.elements.Element | null,\n    elements: null as stripe.elements.Elements | null,\n    isReady: false,\n    okToSubmit: false,\n    stripe: null as stripe.Stripe | null,\n  }),\n  computed: {\n    classes (): object {\n      return {\n        ...VTextField.options.computed.classes.call(this),\n        'v-stripe-card': true,\n      }\n    },\n    theme (): VuetifyThemeVariant {\n      return this.$vuetify.theme.currentTheme\n    },\n  },\n  watch: {\n    isDark (val: boolean, oldVal: boolean) {\n      // if the theme changes and a card has already been initialized\n      if (val !== oldVal && this.card !== null) {\n        // extract key variables from the context\n        const { isDark, fontName, theme, customStyle } = this\n        // generate styles to match the theme\n        const style = this.genStyle(customStyle, fontName, isDark, theme)\n        // then update the card\n        this.card.update({ style })\n      }\n    },\n    isDisabled (val: boolean, oldVal: boolean) {\n      // if the disabled status changes and the card has already been initialized\n      if (val !== oldVal && this.card !== null) {\n        // update its disabled status\n        this.card.update({ disabled: val })\n      }\n    },\n  },\n  mounted () {\n    // make sure the API key is set correctly\n    this.checkAPIKey(this.apiKey)\n    // make sure the Stripe.js library is loaded\n    this.loadStripe()\n  },\n  methods: {\n    /**\n     * Checks the API key and warns the user if they are using a secret\n     * key (instead of a public key), or if they are using a test key.\n     *\n     * @param {string} key An API key\n     */\n    checkAPIKey (key: string): void {\n      // if they are using a secret key\n      if (/^sk_/.test(key)) {\n        console.error('[VStripeCard Error] It looks like you are using a SECRET API key! You should be using your PUBLIC API key. If you have mistakenly made your secret key publicly available on the web, you should strongly consider rolling your API keys. See: https://stripe.com/docs/keys#keeping-your-keys-safe')\n      }\n      // if they are using a test key\n      if (/^pk_test/.test(key)) {\n        console.warn('[VStripeCard Warning] Your `v-stripe-card` instance was initialized with a TEST key. This is correct and appropriate for development and/or testing environments. For production environments, please use your LIVE key. See https://stripe.com/docs/keys for more information.')\n      }\n    },\n    clearableCallback () {\n      this.card !== null && this.card.clear()\n      VTextField.options.methods.clearableCallback.call(this)\n    },\n    /**\n     * Instantiates a Stripe card element and mounts it in the DOM.\n     */\n    genCard () {\n      // extract props from the context\n      const { disabled, fontName, fontUrl, hideIcon, hidePostalCode, iconStyle, isDark, customStyle, theme, zip } = this\n      // use them to generate the options we'll need to generate the Stripe and card instances\n      const style = this.genStyle(customStyle, fontName, isDark, theme)\n      const cardProps = this.genCardProps({ disabled, hideIcon, hidePostalCode, iconStyle, style, zip })\n      // initialize Stripe\n      this.stripe = Stripe(this.apiKey) // eslint-disable-line no-undef\n      // create an Elements generator\n      const font = fontUrl || fontName\n      this.elements = this.stripe.elements(this.genFont(font))\n      // then initialize the card\n      this.card = this.elements.create('card', cardProps)\n      // setup card event handlers and mount the card\n      if (this.card !== null) {\n        this.card.on('blur', this.onCardBlur)\n        this.card.on('change', this.onCardChange)\n        this.card.on('focus', this.onCardFocus)\n        this.card.on('ready', this.onCardReady)\n        this.card.mount(`#${this.computedId}`)\n      }\n    },\n    /**\n     * Generates a well-formed object with all of the values necessary to\n     * correctly create a `stripe.elements.Element` card object.\n     *\n     * @param   {object}                          params                An object with all data necessary to generate valid card props\n     * @param   {boolean}                         params.disabled       Is the input disabled?\n     * @param   {boolean}                         params.hideIcon       Should the card icon be hidden?\n     * @param   {boolean}                         params.hidePostalCode Should the postal code field be hidden?\n     * @param   {string}                          params.iconStyle      'solid' or 'default'\n     * @param   {ElementStyles}                   params.style          Output from `genStyle()`\n     * @param   {string}                          params.zip            Zip code to be pre-filled, if known\n     * @returns {stripe.elements.ElementsOptions}                       Object to be fed to the `stripe.create('card')` function\n     */\n    genCardProps ({\n      disabled = false,\n      hideIcon = false,\n      hidePostalCode = false,\n      iconStyle = 'default' as 'default' | 'solid' | undefined,\n      style = {},\n      zip = '',\n    } = {}): stripe.elements.ElementsOptions {\n      const cardProps: stripe.elements.ElementsOptions = {\n        classes: {\n          base: 'VStripeCard',\n          complete: 'VStripeCard--complete',\n          empty: 'VStripeCard--empty',\n          focus: 'VStripeCard--focus',\n          invalid: 'VStripeCard--invalid',\n          webkitAutofill: 'VStripeCard--webkit-autofill',\n        },\n        disabled,\n        hideIcon,\n        hidePostalCode,\n        iconStyle,\n        style,\n      }\n      zip && (cardProps.value = { postalCode: zip })\n      return cardProps\n    },\n    /**\n     * TODO: Should this throw an error if the font is invalid?\n     * Allows users of the component to specify the font that will be used\n     * inside the text fields generated by Stripe. Does NOT affect the font\n     * used by the label, hint, or error messages. These fonts can/should be\n     * set at the app level along with all of the other UI fonts.\n     *\n     * @param   {string} font The name of a Google font, or a URL to a valid font\n     * @returns {object}      An object in the form required by `Stripe.elements()`\n     */\n    genFont (font = 'Roboto'): stripe.elements.ElementsCreateOptions {\n      const cssSrc = this.isURL(font)\n        ? font\n        : `https://fonts.googleapis.com/css?family=${encodeURI(font)}:400`\n      return { fonts: [{ cssSrc }] }\n    },\n    /**\n     * Generates the HTML element to which the Stripe element will attach\n     * itself. All that is needed is a <div> with a known ID. This <div>\n     * gets replaced by Stripe with an IFrame with their custom inputs.\n     * see: {@link|https://stripe.com/docs/stripe-js/reference#element-mount}\n     */\n    genInput (): VNode {\n      return this.$createElement('div', { attrs: { id: this.computedId, tabindex: -1 } })\n    },\n    /**\n     * Maintains the ability for users of the component to control the\n     * loading/progress indicator of the component, but also shows the\n     * progress bar while the Stripe library is being loaded.\n     */\n    genProgress (): VNode | VNode[] | null {\n      if (this.loading === false && this.isReady) return null\n      return this.$slots.progress || this.$createElement(VProgressLinear, {\n        props: {\n          absolute: true,\n          color: (this.loading === true || this.loading === '')\n            ? (this.color || 'primary')\n            : (this.loading || 'primary'),\n          height: this.loaderHeight,\n          indeterminate: true,\n        },\n      })\n    },\n    /**\n     * Generate styles for Stripe elements\n     *\n     * @param   {string} font\n     */\n    genStyle: (customStyle: ElementStyles, fontName: string, isDark: boolean, theme: VuetifyThemeVariant): ElementStyles => {\n      const defaults: ElementStyles = {\n        base: {\n          color: isDark ? '#ffffff' : '#000000',\n          fontFamily: `'${fontName}', sans-serif`,\n          fontSize: '16px',\n          fontSmoothing: 'antialiased',\n          iconColor: isDark ? '#eceff1' : '#455a64',\n          '::placeholder': {\n            color: isDark ? 'rgb(255,255,255,0.7)' : 'rgb(0,0,0,0.54)',\n          },\n        },\n        invalid: {\n          color: theme.error as string || '#ff5252',\n          iconColor: theme.error as string || '#ff5252',\n        },\n      }\n      return merge(defaults, customStyle)\n    },\n    /**\n     * Loosely validates a URL\n     * Based on: {@link|https://github.com/segmentio/is-url}\n     *\n     * @param   {string}  url The string to be tested\n     * @returns {boolean}     True if the url string passes the test\n     */\n    isURL: (url: string): boolean => {\n      const protocolAndDomainRegex = /^(?:\\w+:)?\\/\\/(\\S+)$/\n      const localhostDomainRegex = /^localhost[:?\\d]*(?:[^:?\\d]\\S*)?$/\n      const nonLocalhostDomainRegex = /^[^\\s.]+\\.\\S{2,}$/\n      if (typeof url !== 'string') return false\n      const match = url.match(protocolAndDomainRegex)\n      if (!match) return false\n      const everythingAfterProtocol = match[1]\n      if (!everythingAfterProtocol) return false\n      if (\n        localhostDomainRegex.test(everythingAfterProtocol) ||\n        nonLocalhostDomainRegex.test(everythingAfterProtocol)\n      ) {\n        return true\n      }\n      return false\n    },\n    /**\n     * Check to see if the Stripe.js library has been loaded into the\n     * browser. If it has not, try to load it. If Stripe cannot be\n     * loaded or there was a problem with loading, an error is thrown.\n     *\n     * @throws  {Error}            Could not load Stripe because `vue-plugin-load-script` is not available\n     * @throws  {Error}            Could not load Stripe because of a network (or other) error\n     */\n    loadStripe () {\n      // Is Stripe already loaded?\n      if (typeof Stripe === 'function') {\n        // Yes. Generate the card.\n        this.genCard()\n      } else {\n        // No. Set the Stripe URL.\n        const src = 'https://js.stripe.com/v3/'\n        // Is it already being loaded by another component?\n        if (document.querySelector(`script[src=\"${src}\"]`)) {\n          // Yes, it's being loaded, so listen for it.\n          this.$root.$once('stripe-loaded', () => {\n            // instantiate the card\n            this.genCard()\n          })\n        } else {\n          // No. Is the script loader installed?\n          if (typeof this.$loadScript === 'undefined') {\n            // No.\n            this.loading = false\n            this.errorBucket.push('Stripe could not be loaded')\n            throw new Error('[VStripeCard Error]: Stripe is not available and could not be loaded. Please make sure that you have installed and configured all of the necessary dependencies to use this component.')\n          } else {\n            // Yes, so try to load it.\n            this.$loadScript(src).then(() => {\n              // Let other potential components know...\n              this.$root.$emit('stripe-loaded')\n              // and generate the card\n              this.genCard()\n            }).catch((error: Error) => {\n              this.loading = false\n              this.errorBucket.push('Error loading stripe: ' + error.message)\n            })\n          }\n        }\n      }\n    },\n    /**\n     * Handles card blur events. Propagates (emits) a blur event to\n     * allow other components to register event handlers that can\n     * respond to the card being blurred.\n     *\n     * @param {ElementChangeResponse} e Event data from the card element\n     */\n    onCardBlur (e: stripe.elements.ElementChangeResponse) {\n      this.isFocused = false\n      // if we have enough info, process the card\n      if (this.okToSubmit) {\n        this.processCard()\n      }\n      this.$emit('blur', e)\n    },\n    /**\n     * Handles card change events. Clears or sets errors in the\n     * `errorBucket`. If the card is empty, sets `lazyValue` to false.\n     *\n     * @param {ElementChangeResponse} e Event data from the card element\n     */\n    onCardChange (e: stripe.elements.ElementChangeResponse) {\n      if (e.error) {\n        // handle card errors\n        this.okToSubmit = false\n        e.error.message && this.errorBucket.push(e.error.message)\n      }\n      if (e.complete) {\n        // handle card input is complete\n        this.okToSubmit = true\n        this.errorBucket = []\n      }\n      if (e.empty) {\n        this.okToSubmit = false\n        this.lazyValue = !e.empty\n      }\n      if (!e.complete) {\n        this.okToSubmit = false\n      }\n    },\n    /**\n     * TODO: Should this function emit? Does it emit the right value?\n     * Handles card focus events. Propagates (emits) a focus event to\n     * allow other components to register event handlers that can\n     * respond to the card being focused.\n     *\n     * @param {ElementChangeResponse} e Event data from the card element\n     */\n    onCardFocus (e: stripe.elements.ElementChangeResponse) {\n      this.isFocused = true\n      this.$emit('focus', true)\n    },\n    /**\n     * Handles card initialization events. Propagates (emits) a ready event to\n     * allow other components to register event handlers that can\n     * respond to the card being ready. Will also focus the card input\n     * if `autofocus` is true.\n     *\n     * @param {ElementChangeResponse} e Event data from the card element\n     */\n    onCardReady (e: stripe.elements.ElementChangeResponse) {\n      this.isReady = true\n      this.autofocus && this.card !== null && this.card.focus()\n      this.$emit('ready', e)\n    },\n    /**\n     * Converts the collected payment information into a single-use token\n     * or a multi-use source that can safely be passed to your backend\n     * API server where a payment request can be processed.\n     *\n     * See {@link|https://stripe.com/docs/stripe-js/reference#stripe-create-token}\n     */\n    async processCard () {\n      if (this.stripe && this.card) {\n        if (this.create === 'token') {\n          const { token, error } = await this.stripe.createToken(this.card, this.options)\n          if (!error) {\n            this.errorBucket = []\n            this.$emit('input', token)\n          } else {\n            // handle error\n            error.message && this.errorBucket.push(error.message)\n          }\n        } else {\n          const { source, error } = await this.stripe.createSource(this.card, this.options)\n          if (!error) {\n            this.errorBucket = []\n            this.$emit('input', source)\n          } else {\n            // handle error\n            error.message && this.errorBucket.push(error.message)\n          }\n        }\n      }\n    },\n  },\n})\n"],"mappings":"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"}